<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="page::html(title=~{::title},main=~{::main})">
<head>
    <title th:text="|*{problemSet.name} (*{problemSet.course.name})|">Problem Set Name (Course Name)</title>
</head>
<body>
    <main th:object="${problemSet}">
        <h1 th:text="|*{name} (*{course.name})|">Problem Set Name (Course Name)</h1>
        <p>
            Deadline: <span class="deadline" th:text="*{#temporals.format(deadline)}">Date</span>
        </p>
        <h2>Solutions</h2>
        <div th:if="*{registeringSolutions}" class="alert alert-info" role="alert">
            Solutions are being registered. Check back later.
        </div>
        <div th:if="*{!registeringSolutions and solutions.empty}" class="alert alert-warning" role="alert">
            No solutions registered yet.
        </div>
        <table class="table" th:unless="*{solutions.empty}">
            <thead>
                <tr>
                    <th>Authors</th>
                    <th>Commit</th>
                    <th>Result</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="sol : *{solutions}">
                    <td th:text="${#strings.setJoin(sol.authors, ', ')}">Authors</td>
                    <td>
                        <span th:if="${sol.latestSubmission != null}" class="font-monospace"
                              th:text="${sol.latestSubmission.commitHash.substring(0,8)}">
                            c0f27a18
                        </span>
                        <span th:if="${sol.latestSubmission == null}">â€”</span>
                    </td>
                    <td>
                        <span th:if="${sol.fetchingSubmission}" class="badge bg-secondary">
                            Fetching submission...
                        </span>
                        <span th:if="${!sol.fetchingSubmission && sol.latestSubmission == null}" class="badge bg-warning">
                            No submission yet
                        </span>
                        <th:block th:if="${sol.latestSubmission != null}" th:switch="${sol.latestSubmission.state.name}">
                            <span th:case="'QUEUED'" class="badge bg-secondary">
                                Queued
                            </span>
                            <span th:case="'GRADING'" class="badge bg-info">
                                Grading...
                            </span>
                            <span th:case="'GRADED'" class="badge bg-primary">
                                Graded
                            </span>
                            <span th:case="'ERROR'" class="badge bg-danger">
                                Error
                            </span>
                        </th:block>
                    </td>
                </tr>
            </tbody>
        </table>
        <p sec:authorize="isAuthenticated()">
            <a href="register-solutions-gitlab.html" th:href="@{register-solutions-gitlab}"
               class="btn btn-primary">Register solutions</a>
        </p>
        <p>
            <a href="../courses/course.html" th:href="@{../..}" class="btn btn-secondary">Back to course</a>
        </p>
    </main>
</body>
</html>
